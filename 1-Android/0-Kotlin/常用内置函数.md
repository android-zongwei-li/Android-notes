# 前言

在`Kotlin`中，有一些用于扩展 & 方便开发者编码的内置函数，能大大提高开发者的开发效率。今天，我将主要讲解的是：

- let函数
- also函数
- with函数
- run函数
- apply函数

------

# 基础知识：接口回调中Lambda使用

在Kotlin中可使用Lambda函数简化一些不必要的嵌套接口回调方法

> 注：仅支持单个抽象方法回调，多个回调方法不支持。



```csharp
 // Java接口回调
mVar.setEventListener(new ExamEventListener(){
 
    public void onSuccess(Data data){
      // ...
    }
 
 });

// 同等效果的Kotlin接口回调（无使用lambda表达式）
mVar.setEventListener(object: ExamEventListener{
     
    public void onSuccess(Data data){
      // ...
    } 
});

// Kotlin接口回调（使用lambda表达式，仅留下参数）
mVar.setEventListener({
   data: Data ->
   // ... 
})

// 继续简化
// 简化1：借助kotlin的智能类型推导，忽略数据类型
mVar.setEventListener({
   data ->
   // ... 
})

// 简化2：若参数无使用，可忽略
mVar.setEventListener({
   // ... 
})

// 简化3：若setEventListener函数最后一个参数是一个函数，可把括号的实现提到圆括号外
mVar.setEventListener(){
   // ... 
}

// 简化3：若setEventListener函数只有一个参数 & 无使用到，可省略圆括号
mVar.setEventListener{
   // ... 
}
```

下面，我将讲解`Kotlin`里提供用于扩展 & 方便开发者编码的几个有用内置函数：let函数、also函数、with函数、 run函数、apply函数。

------

# 1. let函数

### 1.1 简介

![img](https:////upload-images.jianshu.io/upload_images/944365-f4aa360f5492f3f6.png?imageMogr2/auto-orient/strip|imageView2/2/w/1178/format/webp)

### 1.2 使用方法



```csharp
// 作用1：使用it替代object对象去访问其公有的属性 & 方法
object.let{
   it.todo()
}

// 作用2：判断object为null的操作
object?.let{//表示object不为null的条件下，才会去执行let函数体
   it.todo()
}

// 注：返回值 = 最后一行 / return的表达式
```

### 1.3 使用示例



```csharp
// 使用Java
if( mVar != null ){
    mVar.function1();
    mVar.function2();
    mVar.function3();
}

// 使用kotlin（无使用let函数）
mVar?.function1()
mVar?.function2()
mVar?.function3()

// 使用kotlin（使用let函数）
// 方便了统一判空的处理 & 确定了mVar变量的作用域
mVar?.let {
       it.function1()
       it.function2()
       it.function3()
}
```

------

# 2. also函数

### 2.1 作用 & 应用场景

类似let函数，但区别在于返回值：

- let函数：返回值 = 最后一行 / return的表达式
- also函数：返回值 = 传入的对象的本身

### 2.2 使用示例



```csharp
// let函数
var result = mVar.let {
               it.function1()
               it.function2()
               it.function3()
               999
}
// 最终结果 = 返回999给变量result

// also函数
var result = mVar.also {
               it.function1()
               it.function2()
               it.function3()
               999
}
// 最终结果 = 返回一个mVar对象给变量result
```

------

# 3. with函数

### 3.1 作用

调用同一个对象的多个方法 / 属性时，可以省去对象名重复，直接调用方法名 / 属性即可

### 3.2 应用场景

需要调用同一个对象的多个方法 / 属性

### 3.3 使用方法



```csharp
 with(object){
   // ... 
 }

// 返回值 = 函数块的最后一行 / return表达式
```

### 3.4 使用示例



```dart
// 此处要调用people的name 和 age属性
// kotlin
val people = People("carson", 25)
with(people) {
println("my name is $name, I am $age years old")
}

// Java
User peole = new People("carson", 25);
String var1 = "my name is " + peole.name + ", I am " + peole.age + " years old";
System.out.println(var1);
```

------

# 4. run函数

### 4.1 作用 & 应用场景

结合了let、with两个函数的作用，即：

1. 调用同一个对象的多个方法 / 属性时，可以省去对象名重复，直接调用方法名 / 属性即可
2. 定义一个变量在特定作用域内
3. 统一做判空处理

### 4.2 使用方法



```csharp
object.run{
// ... 
}
// 返回值 = 函数块的最后一行 / return表达式
```

### 4.3 使用示例



```dart
// 此处要调用people的name 和 age属性，且要判空
// kotlin
val people = People("carson", 25)
people?.run{
    println("my name is $name, I am $age years old")
}

// Java
User peole = new People("carson", 25);
String var1 = "my name is " + peole.name + ", I am " + peole.age + " years old";
System.out.println(var1);
```

------

# 5. apply函数

### 5.1 作用 & 应用场景

与run函数类似，但区别在于返回值：

- run函数返回最后一行的值 / 表达式
- apply函数返回传入的对象的本身

### 5.2 应用场景

对象实例初始化时需要对对象中的属性进行赋值 & 返回该对象

### 5.3 使用示例



```kotlin
// run函数
val people = People("carson", 25)
val result = people?.run{
    println("my name is $name, I am $age years old")
    999
}
// 最终结果 = 返回999给变量result

// apply函数
val people = People("carson", 25)
val result = people?.apply{
    println("my name is $name, I am $age years old")
    999
}
// 最终结果 = 返回一个people对象给变量result
```

------

# 特别注意

上面都是判非空所做的行为，那如果需要是空的时候做操作呢？答案：在末尾接 ?:



```rust
str?.let {
    // 非空时的行为
} ?: let {
    // 为空时的操作
}
```

至此，关于`Kotlin`里提供用于扩展 & 方便开发者编码的几个有用内置函数讲解完毕。

------

# 总结

![img](https:////upload-images.jianshu.io/upload_images/944365-cc313d85811a78f2.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp)



# 参考

[Kotlin：巧用内置函数let、also、with、run、apply大大提高开发效率！](https://www.jianshu.com/p/e3ae07461a21)